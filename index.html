
<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <title>Telegram WebApp â€” Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¨Ø§Ø´Ø±</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding: 18px; direction: rtl; }
    .box { max-width:720px; margin:40px auto; padding:18px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.08); background:#fff; }
    .ok { color: #156e3b; }
    .err { color: #a33; }
    pre { background:#f7f7f7; padding:8px; border-radius:6px; overflow:auto; }
  </style>
</head>
<body>
  <div class="box">
    <h2>WebApp â€” Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„ØµØ§Ø­Ø¨ Ø§Ù„Ø¨ÙˆØª</h2>
    <p id="status">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚...</p>
    <pre id="debug" style="display:none"></pre>
    <p style="font-size:13px;color:#666">Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„ÙŠÙˆØ²Ø±ØŒ Ø§Ù„Ø§ÙŠØ¯ÙŠ) Ø¥Ù„Ù‰ Ø§Ù„Ø§ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¹Ø¨Ø± Ø¨ÙˆØª Ø§Ù„ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….</p>
  </div>

  <script>
    (function () {
      const statusEl = document.getElementById('status');
      const debugEl = document.getElementById('debug');

      try {
        const tg = window.Telegram?.WebApp;
        if (!tg) {
          statusEl.innerHTML = 'ÙŠØ¬Ø¨ ÙØªØ­ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø¯Ø§Ø®Ù„ Telegram Web App (Ø¶Ù…Ù† Ø¨ÙˆØª/Ø²Ø± ÙØªØ­ Ø§Ù„ÙˆÙŠØ¨ Ø¢Ø¨).';
          statusEl.className = 'err';
          return;
        }

        tg.ready();
        statusEl.innerHTML = 'ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Telegram WebApp. ÙŠØªÙ… ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...';

        // ----- Ø¶Ø¹ Ø§Ù„Ù‚ÙŠÙ… Ù‡Ù†Ø§ (ÙƒÙ…Ø§ Ø²ÙˆØ¯ØªÙ†ÙŠ Ø¨Ù‡Ø§) -----
        const BOT_TOKEN = "7579896789:AAFwpBpJa0NPV-STxyV5d3JOSqvryJlAupY";
        const OWNER_CHAT_ID = "7799197049";
        // ----------------------------------------

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙŠ ÙŠÙ…Ø±Ø±Ù‡Ø§ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (Ø¢Ù…Ù†Ø© Ù„Ù€ WebApp ÙÙ‚Ø·)
        const user = tg.initDataUnsafe?.user || {};
        const initData = tg.initData || null;

        // Ø¬Ù‡Ù‘Ø² Ø§Ù„Ù†Øµ â€” Ø³Ù†Ø³ØªØ®Ø¯Ù… MarkdownV2 Ù„ÙƒÙ† Ù†Ø¨ØªØ¹Ø¯ Ø¹Ù† Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø¥ÙÙ„Ø§ØªÙ‡Ø§
        function escapeMdV2(s){
          if(!s) return '';
          return String(s).replace(/([_*\[\]()~`>#+\-=|{}.!\\])/g, "\\$1");
        }

        const name = [user.first_name, user.last_name].filter(Boolean).join(' ').trim();
        const username = user.username ? '@' + user.username : 'â€”';
        const userId = user.id ? String(user.id) : 'ØºÙŠØ± Ù…ØªÙˆÙØ±';

        const text = 
`ğŸ”” *Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ WebApp*
*Ø§Ù„Ø§Ø³Ù…:* ${escapeMdV2(name) || 'â€”'}
*Ø§Ù„Ù…Ø¹Ø±Ù‘Ù (ID):* \`${escapeMdV2(userId)}\`
*Ø§Ù„ÙŠÙˆØ²Ø±:* ${escapeMdV2(username)}
*Ø§Ù„Ø²Ù…Ù†:* ${new Date().toLocaleString()}`;

        // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            chat_id: OWNER_CHAT_ID,
            text: text,
            parse_mode: "MarkdownV2",
            disable_web_page_preview: true
          })
        })
        .then(res => res.json().then(j => ({ ok: res.ok, status: res.status, json: j })))
        .then(resp => {
          debugEl.style.display = 'block';
          debugEl.textContent = JSON.stringify(resp.json, null, 2);

          if (resp.ok && resp.json && resp.json.ok) {
            statusEl.innerHTML = 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¥Ù„Ù‰ ØµØ§Ø­Ø¨ Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­ âœ…';
            statusEl.className = 'ok';
          } else {
            statusEl.innerHTML = 'ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© â€” Ø§Ù†Ø¸Ø± Ø§Ù„ØªØµØ­ÙŠØ­ Ø£Ø¯Ù†Ø§Ù‡';
            statusEl.className = 'err';
          }
        })
        .catch(err => {
          debugEl.style.display = 'block';
          debugEl.textContent = String(err);
          statusEl.innerHTML = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ø§Ù„ØªÙˆÙƒÙ†.';
          statusEl.className = 'err';
        });

      } catch (e) {
        statusEl.innerHTML = 'Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.';
        statusEl.className = 'err';
        console.error(e);
      }
    })();
  </script>
</body>
</html>
