<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🔒 وصول محمي</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body { font-family: Arial; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; background:#f0f2f5;}
.container { text-align:center; padding:30px; border-radius:15px; background:white; box-shadow:0 10px 30px rgba(0,0,0,0.2);}
h2 { color:#2A9DF4;}
.error { color:red; }
</style>
</head>
<body>
<div class="container" id="content">
<h2>🔄 جاري التحقق...</h2>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// تحقق إذا تم الوصول من Telegram WebApp
const user = tg.initDataUnsafe && tg.initDataUnsafe.user ? tg.initDataUnsafe.user : null;

// رابط الملف JSON على GitHub (Raw URL)
const allowedIDsUrl = "https://raw.githubusercontent.com/hamedareqi/EnglishQuiz/refs/heads/main/allowed.json";

fetch(allowedIDsUrl)
  .then(res => res.json())
  .then(data => {
    const ids = data.allowed_ids;
    const contentDiv = document.getElementById("content");

    if(user && ids.includes(user.id)) {
      contentDiv.innerHTML = `<h2>🎉 مرحباً ${user.first_name}</h2>
                              <p>تم السماح لك بالدخول</p>`;
      // ضع هنا باقي محتوى التطبيق
    } else {
      contentDiv.innerHTML = `<h2 class="error">❌ عذراً، ليس لديك إذن للوصول</h2>
                              <p>يجب فتح الصفحة من داخل Telegram WebApp بمستخدم مصرح له.</p>`;
    }
  })
  .catch(err => {
    console.error("خطأ في جلب قائمة IDs:", err);
    document.getElementById("content").innerHTML = `<h2 class="error">حدث خطأ، يرجى المحاولة لاحقاً</h2>`;
  });
</script>
</body>
</html>
